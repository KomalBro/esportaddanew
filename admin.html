<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Esport Adda</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <h2>Esport Adda</h2>
            </div>
            <div class="nav-links">
                <div class="nav-item active" data-section="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" data-section="games">
                    <i class="fas fa-gamepad"></i>
                    <span>Games</span>
                </div>
                <div class="nav-item" data-section="tournaments">
                    <i class="fas fa-trophy"></i>
                    <span>Tournaments</span>
                </div>
                <div class="nav-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                </div>
                <div class="nav-item" data-section="transactions">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transactions</span>
                </div>
                <div class="nav-item" data-section="withdrawals">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Withdrawals</span>
                </div>
                <div class="nav-item" data-section="activities">
                    <i class="fas fa-history"></i>
                    <span>Activities</span>
                </div>
                <div class="nav-item" data-section="support">
                    <i class="fas fa-headset"></i>
                    <span>Support</span>
                </div>
                <div class="nav-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="nav-item" id="logout">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboardSection" class="section active">
                <h2>Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Users</h3>
                        <div class="value" id="total-users">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Active Games</h3>
                        <div class="value" id="active-games">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Active Tournaments</h3>
                        <div class="value" id="active-tournaments">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Pending Withdrawals</h3>
                        <div class="value" id="pending-withdrawals">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Today's Transactions</h3>
                        <div class="value" id="total-transactions">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Open Support Tickets</h3>
                        <div class="value" id="open-tickets">0</div>
                    </div>
                </div>
            </section>

            <!-- Users Section -->
            <section id="usersSection" class="section" style="display: none;">
                <h2>Users Management</h2>
                <div class="table-wrapper">
                    <table id="users-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Games Played</th>
                                <th>Total Winnings</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body"></tbody>
                    </table>
                </div>
            </section>

            <!-- Games Section -->
            <section id="gamesSection" class="section">
                <h2>Games Management</h2>
                <button class="add-btn" onclick="addGame()">Add New Game</button>
                <div class="table-wrapper">
                    <table id="games-table">
                        <thead>
                            <tr>
                                <th>Icon</th>
                                <th>Name</th>
                                <th>Platform</th>
                                <th>Status</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="games-list"></tbody>
                    </table>
                </div>
            </section>

            <!-- Tournaments Section -->
            <section id="tournamentsSection" class="section">
                <h2>Tournaments Management</h2>
                <button class="add-btn" onclick="addTournament()">Add New Tournament</button>
                <div class="table-wrapper">
                    <table id="tournaments-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Game</th>
                                <th>Entry Fee</th>
                                <th>Prize Pool</th>
                                <th>Players</th>
                                <th>Start Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tournaments-list"></tbody>
                    </table>
                </div>
            </section>

            <!-- Activities Section -->
            <section id="activitiesSection" class="section">
                <h2>User Activities</h2>
                <div class="table-wrapper">
                    <table id="activities-table">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Device</th>
                                <th>Location</th>
                                <th>Timestamp</th>
                            </tr>
                        </thead>
                        <tbody id="activities-list"></tbody>
                    </table>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactionsSection" class="section" style="display: none;">
                <h2>Transactions</h2>
                <div class="table-wrapper">
                    <table id="transactions-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-table-body"></tbody>
                    </table>
                </div>
            </section>

            <!-- Withdrawals Section -->
            <section id="withdrawalsSection" class="section" style="display: none;">
                <h2>Withdrawals</h2>
                <div class="table-wrapper">
                    <table id="withdrawals-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Method</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawals-table-body"></tbody>
                    </table>
                </div>
            </section>

            <!-- Support Section -->
            <section id="supportSection" class="section">
                <h2>Support Tickets</h2>
                <div class="table-wrapper">
                    <table id="support-table">
                        <thead>
                            <tr>
                                <th>Ticket ID</th>
                                <th>User</th>
                                <th>Subject</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="support-list"></tbody>
                    </table>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="section" style="display: none;">
                <h2>Platform Settings</h2>
                <div class="settings-container">
                    <!-- Basic Settings -->
                    <div class="settings-card">
                        <h3>Basic Settings</h3>
                        <form id="basicSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="platformName">Platform Name</label>
                                <input type="text" id="platformName" required>
                            </div>
                            <div class="form-group">
                                <label for="appVersion">App Version</label>
                                <input type="text" id="appVersion" required>
                            </div>
                            <div class="form-group">
                                <label for="contactEmail">Contact Email</label>
                                <input type="email" id="contactEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="supportPhone">Support Phone</label>
                                <input type="tel" id="supportPhone" required>
                            </div>
                            <div class="form-group">
                                <label for="currency">Currency</label>
                                <input type="text" id="currency" required>
                            </div>
                        </form>
                    </div>

                    <!-- Game Settings -->
                    <div class="settings-card">
                        <h3>Game Settings</h3>
                        <form id="gameSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="minPlayers">Minimum Players</label>
                                <input type="number" id="minPlayers" min="2" required>
                            </div>
                            <div class="form-group">
                                <label for="maxPlayers">Maximum Players</label>
                                <input type="number" id="maxPlayers" min="2" required>
                            </div>
                            <div class="form-group">
                                <label for="platformFee">Platform Fee (%)</label>
                                <input type="number" id="platformFee" min="0" max="100" required>
                            </div>
                            <div class="form-group">
                                <label for="registrationBuffer">Registration Buffer (minutes)</label>
                                <input type="number" id="registrationBuffer" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="resultSubmissionWindow">Result Submission Window (minutes)</label>
                                <input type="number" id="resultSubmissionWindow" min="0" required>
                            </div>
                        </form>
                    </div>

                    <!-- Reward Settings -->
                    <div class="settings-card">
                        <h3>Reward Settings</h3>
                        <form id="rewardSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="referralReward">Referral Reward (₹)</label>
                                <input type="number" id="referralReward" min="0" required>
                                <small>Amount given to both referrer and referee</small>
                            </div>
                            <div class="form-group">
                                <label for="joiningBonus">Joining Bonus (₹)</label>
                                <input type="number" id="joiningBonus" min="0" required>
                                <small>Amount given to new users upon registration</small>
                            </div>
                        </form>
                    </div>

                    <!-- Withdrawal Settings -->
                    <div class="settings-card">
                        <h3>Withdrawal Settings</h3>
                        <form id="withdrawalSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="minWithdrawal">Minimum Withdrawal (₹)</label>
                                <input type="number" id="minWithdrawal" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="maxWithdrawal">Maximum Withdrawal (₹)</label>
                                <input type="number" id="maxWithdrawal" min="0" required>
                            </div>
                        </form>
                    </div>

                    <!-- Social Links -->
                    <div class="settings-card">
                        <h3>Social Links</h3>
                        <form id="socialSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="whatsapp">WhatsApp Link</label>
                                <input type="url" id="whatsapp" required>
                            </div>
                            <div class="form-group">
                                <label for="telegram">Telegram Link</label>
                                <input type="url" id="telegram" required>
                            </div>
                            <div class="form-group">
                                <label for="discord">Discord Link</label>
                                <input type="url" id="discord" required>
                            </div>
                        </form>
                    </div>

                    <!-- Maintenance Settings -->
                    <div class="settings-card">
                        <h3>Maintenance Settings</h3>
                        <form id="maintenanceSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="maintenanceMode">
                                    Maintenance Mode
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="maintenanceMessage">Maintenance Message</label>
                                <textarea id="maintenanceMessage" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="forceUpdate">
                                    Force Update
                                </label>
                            </div>
                        </form>
                    </div>

                    <button onclick="saveAllSettings()" class="action-button">Save All Settings</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Add debug logging
        console.log('Loading admin panel...');
        window.addEventListener('DOMContentLoaded', (event) => {
            console.log('DOM fully loaded');
            // Check if Firebase is loaded
            if (typeof firebase !== 'undefined') {
                console.log('Firebase is loaded');
            } else {
                console.error('Firebase is not loaded');
            }
        });
    </script>
    <script src="admin.js"></script>
    
    <script>
        // Initialize event listeners after DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Add click handlers for nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    const section = item.getAttribute('data-section');
                    showSection(section);
                });
            });

            // Close modal when clicking outside
            document.querySelector('.modal').addEventListener('click', (event) => {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });

            // Close modal when clicking close button
            document.querySelector('.close-modal').addEventListener('click', () => {
                document.querySelector('.modal').style.display = 'none';
            });
        });
    </script>
</body>
</html>